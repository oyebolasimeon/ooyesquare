<div class="admin-layout">
  <app-admin-sidebar #sidebar [activeRoute]="'contestants'"></app-admin-sidebar>
  
  <div class="main-content">
    <app-admin-topbar [title]="'Manage Contestants'" [icon]="'pi-users'" (toggleMenu)="sidebar.toggleMobileMenu()"></app-admin-topbar>
    
    <div class="content-area">
      <div class="contestants-container">
        <div class="toolbar">
          <div class="search-container">
            <span class="p-input-icon-left search-box">
              <i class="pi pi-search"></i>
              <input type="text" 
                     pInputText 
                     [(ngModel)]="searchText" 
                     (input)="filterContestants()" 
                     placeholder="Search by name, position, category..."
                     class="search-input" />
              <i class="pi pi-times clear-icon" 
                 *ngIf="searchText" 
                 (click)="clearSearch()"
                 pTooltip="Clear search"></i>
            </span>
            <div class="results-info" *ngIf="searchText">
              <span>{{ filteredContestants.length }} of {{ contestants.length }} contestants</span>
            </div>
          </div>
          <button pButton label="New Contestant" icon="pi pi-plus" (click)="openNewDialog()" class="add-btn"></button>
        </div>

        <!-- Contestants Table -->
        <p-card>
          <p-table [value]="filteredContestants" [loading]="loading" [paginator]="true" [rows]="rowsPerPage" 
                   [rowsPerPageOptions]="rowsPerPageOptions" [showCurrentPageReport]="true"
                   currentPageReportTemplate="Showing {first} to {last} of {totalRecords} contestants"
                   responsiveLayout="scroll" styleClass="p-datatable-striped">
            <ng-template pTemplate="header">
              <tr>
                <th>Contestant Name</th>
                <th>Position</th>
                <th>Category</th>
                <th>Bio</th>
                <th>Actions</th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-contestant>
              <tr>
                <td>
                  {{ contestant.firstName }} {{ contestant.lastName }}
                  <span *ngIf="contestant.maidenName" class="maiden-name">({{ contestant.maidenName }})</span>
                </td>
                <td>{{ getPositionName(contestant) }}</td>
                <td>
                  <p-tag [value]="getPositionCategory(contestant)" 
                         [severity]="getPositionCategory(contestant) === 'National' ? 'info' : 'warn'"></p-tag>
                </td>
                <td>
                  <div class="bio-cell">{{ contestant.bio || '-' }}</div>
                </td>
                <td class="action-buttons">
                  <button pButton 
                          type="button"
                          icon="pi pi-pencil" 
                          (click)="openEditDialog(contestant)" 
                          class="p-button-rounded p-button-text p-button-sm edit-btn" 
                          pTooltip="Edit"
                          tooltipPosition="top"></button>
                  <button pButton 
                          type="button"
                          icon="pi pi-trash" 
                          (click)="deleteContestant(contestant)" 
                          class="p-button-rounded p-button-text p-button-sm delete-btn" 
                          pTooltip="Delete"
                          tooltipPosition="top"></button>
                </td>
              </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
              <tr>
                <td colspan="5" class="empty-message">
                  <div class="empty-state">
                    <i class="pi pi-inbox" style="font-size: 3rem; color: #94A3B8;"></i>
                    <p>No contestants found. Add your first contestant to get started.</p>
                  </div>
                </td>
              </tr>
            </ng-template>
          </p-table>
        </p-card>
      </div>
    </div>
  </div>

  <!-- Toast Messages -->
  <p-toast></p-toast>

</div>
