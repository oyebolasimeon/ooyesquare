<div class="admin-layout">
  <app-admin-sidebar #sidebar [activeRoute]="'positions'"></app-admin-sidebar>
  
  <div class="main-content">
    <app-admin-topbar [title]="'Manage Positions'" [icon]="'pi-briefcase'" (toggleMenu)="sidebar.toggleMobileMenu()"></app-admin-topbar>
    
    <div class="content-area">
      <div class="positions-container">
        <div class="toolbar">
          <div class="search-container">
            <span class="p-input-icon-left search-box">
              <i class="pi pi-search"></i>
              <input type="text" 
                     pInputText 
                     [(ngModel)]="searchText" 
                     (input)="filterPositions()" 
                     placeholder="Search by name, title, category, state..."
                     class="search-input" />
              <i class="pi pi-times clear-icon" 
                 *ngIf="searchText" 
                 (click)="clearSearch()"
                 pTooltip="Clear search"></i>
            </span>
            <div class="results-info" *ngIf="searchText">
              <span>{{ filteredPositions.length }} of {{ positions.length }} positions</span>
            </div>
          </div>
          <button pButton label="New Position" icon="pi pi-plus" (click)="openNewDialog()" class="add-btn"></button>
        </div>

        <!-- Positions Table -->
        <p-card>
          <p-table [value]="filteredPositions" [loading]="loading" [paginator]="true" [rows]="rowsPerPage" 
                   [rowsPerPageOptions]="rowsPerPageOptions" [showCurrentPageReport]="true"
                   currentPageReportTemplate="Showing {first} to {last} of {totalRecords} positions"
                   responsiveLayout="scroll" styleClass="p-datatable-striped">
            <ng-template pTemplate="header">
              <tr>
                <th>Position Name</th>
                <th>Category</th>
                <th>State</th>
                <th>Actions</th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-position>
              <tr>
                <td>{{ position.title }}</td>
                <td>
                  <p-tag [value]="position.category" 
                         [severity]="position.category === 'National' ? 'info' : 'warn'"></p-tag>
                </td>
                <td>{{ position.state || '-' }}</td>
                <td class="action-buttons">
                  <button pButton 
                  type="button"
                  icon="pi pi-pencil" 
                  (click)="openEditDialog(position)" 
                  class="p-button-rounded p-button-text p-button-md edit-btn p-2" 
                  pTooltip="Edit"
                  tooltipPosition="top"></button>
                  <button pButton 
                  type="button"
                  icon="pi pi-trash" 
                  (click)="deletePosition(position)" 
                  class="p-button-rounded p-button-text p-button-md delete-btn p-2" 
                  pTooltip="Delete"
                  tooltipPosition="top"></button>
                </td>
              </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
              <tr>
                <td colspan="4" class="empty-message">
                  <div class="empty-state">
                    <i class="pi pi-inbox" style="font-size: 3rem; color: #94A3B8;"></i>
                    <p>No positions found. Create your first position to get started.</p>
                  </div>
                </td>
              </tr>
            </ng-template>
          </p-table>
        </p-card>
      </div>
    </div>
  </div>

  <!-- Toast Messages -->
  <p-toast></p-toast>

</div>
